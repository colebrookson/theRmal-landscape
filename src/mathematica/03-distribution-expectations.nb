(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     31930,        742]
NotebookOptionsPosition[     30822,        715]
NotebookOutlinePosition[     31216,        731]
CellTagsIndexPosition[     31173,        728]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Expected probability of infection", "Title",
 CellChangeTimes->{{3.962811438628427*^9, 
  3.962811445205813*^9}},ExpressionUUID->"9b064bd4-2d6b-4429-bb90-\
3ff55700105a"],

Cell["\<\
To test whether or not our expression for the probability of co-location (and \
infection, if temperature-dependent transmission is equal to 1) matched \
simulated values for each of our different assumptions, we simulated all of \
them across a range of values. \
\>", "Text",
 CellChangeTimes->{{3.962811450206868*^9, 3.96281146105177*^9}, {
  3.962811515861713*^9, 3.962811554155175*^9}, {3.96281158558314*^9, 
  3.962811600963038*^9}},ExpressionUUID->"e7e2ddb2-7e92-4cf1-90cb-\
9715657c9334"],

Cell[CellGroupData[{

Cell["Uniform distribution", "Section",
 CellChangeTimes->{{3.962811612572472*^9, 
  3.962811615049329*^9}},ExpressionUUID->"e1119d78-dffc-47d5-ac4a-\
fd539da22a1f"],

Cell["\<\
If we assume that the expectation of our simulation can be given by a known \
distribution or by just constant values, we can then calculate our expected \
values and test whether or not they align with what the simulated values \
show. \
\>", "Text",
 CellChangeTimes->{{3.962811617897418*^9, 3.962811619807137*^9}, {
  3.964261440791171*^9, 
  3.9642614738717947`*^9}},ExpressionUUID->"3f17c6ac-d29a-4c26-9b5a-\
2b0f9c332007"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"First", ",", " ", 
    RowBox[{
    "some", " ", "directory", " ", "stuff", " ", "for", " ", "outputting", " ",
      "plot"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
    "baseDir", "=", "\"\</Users/colebrookson/github/theRmal-landscape/\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"figsDir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"baseDir", ",", "\"\<figs\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"relativePath", "[", "parts__", "]"}], ":=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"baseDir", ",", "parts"}], "}"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Np", "=", "100"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Number", " ", "of", " ", "Patches"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NI", "=", "1"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Number", " ", "of", " ", "Infected", " ", "Individuals"}], " ", 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reps", "=", "10000"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Replications", " ", "to", " ", "do", " ", "for", " ", "each", " ", 
     "parameter", " ", "set"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"This", " ", "counts", " ", "the", " ", "fraction", " ", "of", " ", 
      RowBox[{"successes", " ", "--"}], " ", "colacations", " ", "of", " ", 
      "infected", " ", "and", " ", "susceptible", " ", "indivdiuals", " ", 
      "in", " ", "each", " ", "trial"}], ",", " ", 
     RowBox[{
     "across", " ", "a", " ", "range", " ", "of", " ", "the", " ", "number", " ",
       "of", " ", "susceptibles"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "result", " ", "is", " ", "invariant", " ", "when", " ", 
     "expressed", " ", "as", " ", "a", " ", "ratio", " ", "of", " ", 
     RowBox[{"S", "/", 
      RowBox[{"N", " ", "--"}]}], " ", "number", " ", "of", " ", 
     "susceptibles", " ", "per", " ", "number", " ", "of", " ", "patches"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "success", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"success", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"weights", "=", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"1", ",", "Np"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{"Sloc", "=", 
              RowBox[{"RandomChoice", "[", 
               RowBox[{
                RowBox[{"weights", "->", 
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "Np", ",", "1"}], "]"}]}], ",", "NS"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Iloc", "=", 
              RowBox[{"RandomChoice", "[", 
               RowBox[{
                RowBox[{"weights", "->", 
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "Np", ",", "1"}], "]"}]}], ",", "NI"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Intersection", "[", 
                  RowBox[{"Sloc", ",", "Iloc"}], "]"}], "]"}], ">", "0"}], ",", 
               RowBox[{"success", "++"}]}], "]"}]}], ",", 
            RowBox[{"{", "reps", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NS", "/", "Np"}], ",", 
            RowBox[{"N", "[", 
             RowBox[{"success", "/", "reps"}], "]"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"NS", ",", "1", ",", "Np"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "I", " ", "want", " ", "points", " ", "that", " ", "have", " ", "a", " ", 
     "border", " ", "so", " ", 
     RowBox[{"they", "'"}], "re", " ", "easier", " ", "to", " ", "see"}], 
    "*)"}], "\n", 
   RowBox[{"plot1", "=", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"{", "output", "}"}], ",", 
      RowBox[{"Frame", "->", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",",
       "\n", "\t", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], ",", "\n", "\t", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RGBColor", "[", "\"\<#9381ff\>\"", "]"}], ",", " ", 
         RowBox[{"Opacity", "[", "0.1", "]"}]}], "}"}]}], ",", " ", "\n", 
      "\t", 
      RowBox[{"FrameLabel", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<S/N\>\"", ",", "\"\<Prob. of co-location\>\""}], "}"}]}],
       ",", "\n", "\t", 
      RowBox[{"PlotLegends", "->", 
       RowBox[{"{", "\"\<constant \!\(\*TemplateBox[<|\"boxes\" -> FormBox[
SubscriptBox[
StyleBox[\"w\", \"TI\"], 
StyleBox[\"i\", \"TI\"]], TraditionalForm], \"errors\" -> {}, \"input\" -> \
\"w_{i}\", \"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\"", 
        "}"}]}]}], "]"}]}], "\[IndentingNewLine]"}]}]], "Code",
 CellChangeTimes->{{3.9642614843747587`*^9, 3.9642615037484283`*^9}, 
   3.964261542432269*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"1e77069e-428f-4574-9e5c-27eda31ab296"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{}, 
     InterpretationBox[{
       TagBox[
        TagBox[{
          RGBColor[0.5764705882352941, 0.5058823529411764, 1.], 
          PointSize[0.009166666666666668], 
          AbsoluteThickness[2], 
          PointBox[CompressedData["
1:eJw1lAtQVGUUx4nIlDCiKE3BwseIQzNMPoBM/JtkYpoINckIOmbgGDEKGamQ
rxCxzAcoagwxKQhBzALK0xZBVt6Iu+0ul2WX3ftY2F1gwUgYFR/tvZ2+mZ07
d7/vnnP+/985n8+OPRGxzk5OTjGOn/hM8ZSt5ZKPYalHwIq6iOP47/08HjTG
FG//LBM1c9KGwmtysXhAtsCcmkv7+Ugv3Ny++PZlZP8iriIUuH60IMm5mM7L
4N3Wj3yTDMPh4j/lmDY7d9uijjL6vgKzGqLe/uDv63Bl8hKCXatR9c8TzX5b
FcWrhftLlQUHWmqxKPpM47ivHBn277Fs2w2KfxOqjOinIY/qkO/4mslrQIjX
EB8wq4Hy3cK9wub1gT/ewhJpKfBxSqr/hoJGyn8b9+M/PyiraoRi3NeRoQlh
q177QqFWUD0tcLH87Guf3owIKWEr4uTfnpvp0kz1tQGbo8rrh5vBJYsB26FQ
+8W+ybdSvZ0Qo/nFtiFRLC/hDjZIBrVT/V2ilnVuzh1wkpYS8/QPD8XJO0mP
Es98nkwksZ0IlRKosEsyoIv0qajOuxCzRZ/5i/QrSa8aTU+vpYyVKSEdY9S4
7pZYclKvJP0afHJseljpeRXeEsuZo8Xq7f3KuXoV+aHF1BKvLTHvq7FTWt1Q
iO0Qoaa8DL5y2nPUpUkNMZqnjME3D91t1aVq8quHnhpMiOHGe7BxxyuR71Vo
yD8djm9RywVPLSR7gnupn7TkZy9qH6ff1zNaSOWl6dE3f8rRrBCG/DVgf/LV
d0K8GNzpFJcBccbEn06bu8nvPtLNQJLraYS0PcaQ/0ZkaabtmhvfAylctAke
LTdqTk3pIR4sdMEHIn9fpiMdLET1C3/TER8WH56Mt0wW6Ugfi7s7tZY4v17i
xWH+xWdnD032kl4Oq/JNN1/O0RM/DpWvT3aMtOlJP4+F74qOG4gnjyBpAA3k
B4+xsk1fZ+8zEF8BlYHiAQP5I8DbQcsU9r9uAY5mjJxR3Ud+mVH8Q/i6X48Y
ib8ZExf7zqWnGck/M5Kcs6fOzjVSP/Qjwz054I+VJvKzH5e7l44GrTFRf/TD
2S/9DV2XifwdQKY4jnYT9csA/HfnPSd/gSW/ByBNZxRL/WOh+4Yl/y3Iij3x
5VYDS/1kQfa+nCvzalniYYUme8C70MoSDyuOhNYf9A7iiIcVnVvXt74YzBEP
K/ZKA8MRDxvVyxEPG5ZndhwOreeIhw2tl/68cNadJx6DuLT71dSGdo54DGLN
WrHDOeIxCN6Wdc0tkSceQ8SHJx5DODy5PKHrBE88hlAubufwxGMYoZsez9zL
8MRjGKtXWnUlj3jiMYycJVcqAh/wxMOOmtLnHTeSQDzsKMrf6LixBOJhx6cX
fE4nJQrEYwQzpAQC8RiBvzRAAvEYgdQupwTiMYrv2ByPq3UC8RglvwTiMUrz
KBCPexBvv9wVZvwLEA0k1Q==
           "]]}, Annotation[#, "Charting`Private`Tag#1"]& ], {
        "WolframDynamicHighlight", <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>}], 
       StyleBox[
        DynamicBox[
         (Charting`HighlightActionBox["DynamicHighlight", {}, 
          Slot["HighlightElements"], 
          Slot["LayoutOptions"], 
          Slot["Meta"], 
          Charting`HighlightActionFunction["DynamicHighlight", {{
             Annotation[{
               Directive[
                PointSize[0.009166666666666668], 
                AbsoluteThickness[2], 
                RGBColor[0.5764705882352941, 0.5058823529411764, 1.]], 
               Point[CompressedData["
1:eJw1lAtQVGUUx4nIlDCiKE3BwseIQzNMPoBM/JtkYpoINckIOmbgGDEKGamQ
rxCxzAcoagwxKQhBzALK0xZBVt6Iu+0ul2WX3ftY2F1gwUgYFR/tvZ2+mZ07
d7/vnnP+/985n8+OPRGxzk5OTjGOn/hM8ZSt5ZKPYalHwIq6iOP47/08HjTG
FG//LBM1c9KGwmtysXhAtsCcmkv7+Ugv3Ny++PZlZP8iriIUuH60IMm5mM7L
4N3Wj3yTDMPh4j/lmDY7d9uijjL6vgKzGqLe/uDv63Bl8hKCXatR9c8TzX5b
FcWrhftLlQUHWmqxKPpM47ivHBn277Fs2w2KfxOqjOinIY/qkO/4mslrQIjX
EB8wq4Hy3cK9wub1gT/ewhJpKfBxSqr/hoJGyn8b9+M/PyiraoRi3NeRoQlh
q177QqFWUD0tcLH87Guf3owIKWEr4uTfnpvp0kz1tQGbo8rrh5vBJYsB26FQ
+8W+ybdSvZ0Qo/nFtiFRLC/hDjZIBrVT/V2ilnVuzh1wkpYS8/QPD8XJO0mP
Es98nkwksZ0IlRKosEsyoIv0qajOuxCzRZ/5i/QrSa8aTU+vpYyVKSEdY9S4
7pZYclKvJP0afHJseljpeRXeEsuZo8Xq7f3KuXoV+aHF1BKvLTHvq7FTWt1Q
iO0Qoaa8DL5y2nPUpUkNMZqnjME3D91t1aVq8quHnhpMiOHGe7BxxyuR71Vo
yD8djm9RywVPLSR7gnupn7TkZy9qH6ff1zNaSOWl6dE3f8rRrBCG/DVgf/LV
d0K8GNzpFJcBccbEn06bu8nvPtLNQJLraYS0PcaQ/0ZkaabtmhvfAylctAke
LTdqTk3pIR4sdMEHIn9fpiMdLET1C3/TER8WH56Mt0wW6Ugfi7s7tZY4v17i
xWH+xWdnD032kl4Oq/JNN1/O0RM/DpWvT3aMtOlJP4+F74qOG4gnjyBpAA3k
B4+xsk1fZ+8zEF8BlYHiAQP5I8DbQcsU9r9uAY5mjJxR3Ud+mVH8Q/i6X48Y
ib8ZExf7zqWnGck/M5Kcs6fOzjVSP/Qjwz054I+VJvKzH5e7l44GrTFRf/TD
2S/9DV2XifwdQKY4jnYT9csA/HfnPSd/gSW/ByBNZxRL/WOh+4Yl/y3Iij3x
5VYDS/1kQfa+nCvzalniYYUme8C70MoSDyuOhNYf9A7iiIcVnVvXt74YzBEP
K/ZKA8MRDxvVyxEPG5ZndhwOreeIhw2tl/68cNadJx6DuLT71dSGdo54DGLN
WrHDOeIxCN6Wdc0tkSceQ8SHJx5DODy5PKHrBE88hlAubufwxGMYoZsez9zL
8MRjGKtXWnUlj3jiMYycJVcqAh/wxMOOmtLnHTeSQDzsKMrf6LixBOJhx6cX
fE4nJQrEYwQzpAQC8RiBvzRAAvEYgdQupwTiMYrv2ByPq3UC8RglvwTiMUrz
KBCPexBvv9wVZvwLEA0k1Q==
                "]]}, "Charting`Private`Tag#1"]}}, <|
           "HighlightElements" -> <|
             "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
            "LayoutOptions" -> <|
             "PanelPlotLayout" -> <||>, "PlotRange" -> {{0, 1.}, {0., 1.}}, 
              "Frame" -> {{True, False}, {True, False}}, 
              "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
              "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
              GoldenRatio^(-1), "DefaultStyle" -> {
                Directive[
                 PointSize[0.009166666666666668], 
                 AbsoluteThickness[2], 
                 RGBColor[0.5764705882352941, 0.5058823529411764, 1.]]}, 
              "HighlightLabelingFunctions" -> <|
               "CoordinatesToolOptions" -> ({
                  (Identity[#]& )[
                   Part[#, 1]], 
                  (Identity[#]& )[
                   Part[#, 2]]}& ), 
                "ScalingFunctions" -> {{Identity, Identity}, {
                  Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
              False|>, 
            "Meta" -> <|
             "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
              "Function" -> ListPlot, "GroupHighlight" -> False|>|>]]& )[<|
          "HighlightElements" -> <|
            "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
           "LayoutOptions" -> <|
            "PanelPlotLayout" -> <||>, "PlotRange" -> {{0, 1.}, {0., 1.}}, 
             "Frame" -> {{True, False}, {True, False}}, 
             "AxesOrigin" -> {0, 0}, "ImageSize" -> {360, 360/GoldenRatio}, 
             "Axes" -> {True, True}, "LabelStyle" -> {}, "AspectRatio" -> 
             GoldenRatio^(-1), "DefaultStyle" -> {
               Directive[
                PointSize[0.009166666666666668], 
                AbsoluteThickness[2], 
                RGBColor[0.5764705882352941, 0.5058823529411764, 1.]]}, 
             "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
                 (Identity[#]& )[
                  Part[#, 1]], 
                 (Identity[#]& )[
                  Part[#, 2]]}& ), 
               "ScalingFunctions" -> {{Identity, Identity}, {
                 Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> 
             False|>, 
           "Meta" -> <|
            "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, 
             "Function" -> ListPlot, "GroupHighlight" -> False|>|>], 
         ImageSizeCache -> {{4.503599627370496*^15, -4.503599627370496*^15}, {
          4.503599627370496*^15, -4.503599627370496*^15}}], Selectable -> 
        False]}, 
      Annotation[{{
         Annotation[{
           Directive[
            PointSize[0.009166666666666668], 
            AbsoluteThickness[2], 
            RGBColor[0.5764705882352941, 0.5058823529411764, 1.]], 
           Point[CompressedData["
1:eJw1lAtQVGUUx4nIlDCiKE3BwseIQzNMPoBM/JtkYpoINckIOmbgGDEKGamQ
rxCxzAcoagwxKQhBzALK0xZBVt6Iu+0ul2WX3ftY2F1gwUgYFR/tvZ2+mZ07
d7/vnnP+/985n8+OPRGxzk5OTjGOn/hM8ZSt5ZKPYalHwIq6iOP47/08HjTG
FG//LBM1c9KGwmtysXhAtsCcmkv7+Ugv3Ny++PZlZP8iriIUuH60IMm5mM7L
4N3Wj3yTDMPh4j/lmDY7d9uijjL6vgKzGqLe/uDv63Bl8hKCXatR9c8TzX5b
FcWrhftLlQUHWmqxKPpM47ivHBn277Fs2w2KfxOqjOinIY/qkO/4mslrQIjX
EB8wq4Hy3cK9wub1gT/ewhJpKfBxSqr/hoJGyn8b9+M/PyiraoRi3NeRoQlh
q177QqFWUD0tcLH87Guf3owIKWEr4uTfnpvp0kz1tQGbo8rrh5vBJYsB26FQ
+8W+ybdSvZ0Qo/nFtiFRLC/hDjZIBrVT/V2ilnVuzh1wkpYS8/QPD8XJO0mP
Es98nkwksZ0IlRKosEsyoIv0qajOuxCzRZ/5i/QrSa8aTU+vpYyVKSEdY9S4
7pZYclKvJP0afHJseljpeRXeEsuZo8Xq7f3KuXoV+aHF1BKvLTHvq7FTWt1Q
iO0Qoaa8DL5y2nPUpUkNMZqnjME3D91t1aVq8quHnhpMiOHGe7BxxyuR71Vo
yD8djm9RywVPLSR7gnupn7TkZy9qH6ff1zNaSOWl6dE3f8rRrBCG/DVgf/LV
d0K8GNzpFJcBccbEn06bu8nvPtLNQJLraYS0PcaQ/0ZkaabtmhvfAylctAke
LTdqTk3pIR4sdMEHIn9fpiMdLET1C3/TER8WH56Mt0wW6Ugfi7s7tZY4v17i
xWH+xWdnD032kl4Oq/JNN1/O0RM/DpWvT3aMtOlJP4+F74qOG4gnjyBpAA3k
B4+xsk1fZ+8zEF8BlYHiAQP5I8DbQcsU9r9uAY5mjJxR3Ud+mVH8Q/i6X48Y
ib8ZExf7zqWnGck/M5Kcs6fOzjVSP/Qjwz054I+VJvKzH5e7l44GrTFRf/TD
2S/9DV2XifwdQKY4jnYT9csA/HfnPSd/gSW/ByBNZxRL/WOh+4Yl/y3Iij3x
5VYDS/1kQfa+nCvzalniYYUme8C70MoSDyuOhNYf9A7iiIcVnVvXt74YzBEP
K/ZKA8MRDxvVyxEPG5ZndhwOreeIhw2tl/68cNadJx6DuLT71dSGdo54DGLN
WrHDOeIxCN6Wdc0tkSceQ8SHJx5DODy5PKHrBE88hlAubufwxGMYoZsez9zL
8MRjGKtXWnUlj3jiMYycJVcqAh/wxMOOmtLnHTeSQDzsKMrf6LixBOJhx6cX
fE4nJQrEYwQzpAQC8RiBvzRAAvEYgdQupwTiMYrv2ByPq3UC8RglvwTiMUrz
KBCPexBvv9wVZvwLEA0k1Q==
            "]]}, "Charting`Private`Tag#1"]}}, <|
       "HighlightElements" -> <|
         "Label" -> {"XYLabel"}, "Ball" -> {"IndicatedBall"}|>, 
        "LayoutOptions" -> <|
         "PanelPlotLayout" -> <||>, "PlotRange" -> {{0, 1.}, {0., 1.}}, 
          "Frame" -> {{True, False}, {True, False}}, "AxesOrigin" -> {0, 0}, 
          "ImageSize" -> {360, 360/GoldenRatio}, "Axes" -> {True, True}, 
          "LabelStyle" -> {}, "AspectRatio" -> GoldenRatio^(-1), 
          "DefaultStyle" -> {
            Directive[
             PointSize[0.009166666666666668], 
             AbsoluteThickness[2], 
             RGBColor[0.5764705882352941, 0.5058823529411764, 1.]]}, 
          "HighlightLabelingFunctions" -> <|"CoordinatesToolOptions" -> ({
              (Identity[#]& )[
               Part[#, 1]], 
              (Identity[#]& )[
               Part[#, 2]]}& ), 
            "ScalingFunctions" -> {{Identity, Identity}, {
              Identity, Identity}}|>, "Primitives" -> {}, "GCFlag" -> False|>,
         "Meta" -> <|
         "DefaultHighlight" -> {"Dynamic", None}, "Index" -> {}, "Function" -> 
          ListPlot, "GroupHighlight" -> False|>|>, 
       "DynamicHighlight"]], {{}, {}}}, AspectRatio -> 
    NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
    AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction -> 
    Identity, Frame -> {{True, False}, {True, False}}, FrameLabel -> {{
       FormBox[
        TagBox["\"Prob. of co-location\"", HoldForm], TraditionalForm], 
       None}, {
       FormBox[
        TagBox["\"S/N\"", HoldForm], TraditionalForm], None}}, 
    FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
    GridLines -> {None, None}, GridLinesStyle -> Directive[
      GrayLevel[0.5, 0.4]], 
    Method -> {
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultGraphicsInteraction" -> {
       "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
        "Effects" -> {
         "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
          "Droplines" -> {
           "freeformCursorMode" -> True, 
            "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
      "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
        Directive[
         RGBColor[0.24, 0.6, 0.8], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.95, 0.627, 0.1425], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.455, 0.7, 0.21], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.922526, 0.385626, 0.209179], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.578, 0.51, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.772079, 0.431554, 0.102387], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.4, 0.64, 1.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[1., 0.75, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.8, 0.4, 0.76], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.637, 0.65, 0.], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.915, 0.3325, 0.2125], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
         AbsoluteThickness[2]], 
        Directive[
         RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
         AbsoluteThickness[2]]}, "DomainPadding" -> Scaled[0.02], 
      "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05],
       "OptimizePlotMarkers" -> True, "IncludeHighlighting" -> "CurrentPoint",
       "HighlightStyle" -> Automatic, "OptimizePlotMarkers" -> True, 
      "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& ), "CopiedValueFunction" -> ({
          (Identity[#]& )[
           Part[#, 1]], 
          (Identity[#]& )[
           Part[#, 2]]}& )}}, PlotRange -> {{0, 1.}, {0., 1.}}, 
    PlotRangeClipping -> True, PlotRangePadding -> {{
       Scaled[0.02], 
       Scaled[0.02]}, {0, 0}}, Ticks -> {Automatic, Automatic}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"constant \\!\\(\\*TemplateBox[<|\\\"boxes\\\" -> \
FormBox[SubscriptBox[StyleBox[\\\"w\\\", \\\"TI\\\"], StyleBox[\\\"i\\\", \
\\\"TI\\\"]], TraditionalForm], \\\"errors\\\" -> {}, \\\"input\\\" -> \
\\\"w_{i}\\\", \\\"state\\\" -> \\\"Boxes\\\"|>,\\\"TeXAssistantTemplate\\\"]\
\\)\""}, "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[2], 
                    RGBColor[0.5764705882352941, 0.5058823529411764, 1.]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[2], 
                    RGBColor[0.5764705882352941, 0.5058823529411764, 1.]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 12.5}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.18000000000000002`] -> 
                    Baseline)], #}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), Editable -> True, 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{"Directive", "[", 
               RowBox[{
                 RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                 ",", 
                 RowBox[{"AbsoluteThickness", "[", "2", "]"}], ",", 
                 
                 TemplateBox[<|
                  "color" -> 
                   RGBColor[0.5764705882352941, 0.5058823529411764, 1.]|>, 
                  "RGBColorSwatchTemplate"]}], "]"}], "}"}], ",", 
           RowBox[{"{", #, "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"{", 
                 RowBox[{"False", ",", "Automatic"}], "}"}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", "False", "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& )], 
     TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.964261494149713*^9, {3.96426154281677*^9, 3.964261556587063*^9}},
 CellLabel->"Out[24]=",ExpressionUUID->"b2de842c-21f3-4d15-90ef-540c9f86c911"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Add", " ", "the", " ", "expected", " ", "value", " ", "of", " ", "this", " ",
     "based", " ", "on", " ", "the", " ", "math"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"expectation", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NS", "/", "Np"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"1", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"1", "/", "Np"}], ")"}]}], ")"}], "^", "NS"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"NS", ",", "0", ",", "Np"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"plot2", "=", 
    RowBox[{"Show", "[", "\n", "\t", 
     RowBox[{"plot1", ",", "\n", "\t", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"expectation", ",", "\n", "\t\t", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RGBColor", "[", "\"\<#2b2d42\>\"", "]"}], ",", "Dashed"}],
           "}"}]}], ",", "\n", "\t\t", 
        RowBox[{"PlotLegends", "->", 
         RowBox[{"{", "\"\<constant \!\(\*TemplateBox[<|\"boxes\" -> FormBox[
RowBox[{
StyleBox[\"E\", \"TI\"], 
RowBox[{\"[\", 
SubscriptBox[
StyleBox[\"w\", \"TI\"], 
StyleBox[\"i\", \"TI\"]], \"]\"}]}], TraditionalForm], \"errors\" -> {}, \
\"input\" -> \"E[w_i]\", \"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"]\)\
\>\"", "}"}]}]}], "]"}]}], "]"}]}], "\n", "\t\t", "\n", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"relativePath", "[", 
       RowBox[{"\"\<figs/si\>\"", ",", "\"\<constant-expected.pdf\>\""}], 
       "]"}], ",", "plot2", ",", " ", "\n", "\t", 
      RowBox[{"ImageSize", " ", "->", " ", 
       RowBox[{
        RowBox[{"6", "/", "2.54"}], "*", "300"}]}], ",", " ", 
      RowBox[{"ImageResolution", " ", "->", " ", "1200"}]}], "]"}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{
  3.9642615272228823`*^9},ExpressionUUID->"e5bd0fe4-d1ce-4311-abe9-\
44b2975fade9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "try", " ", "it", " ", "with", " ", "random", " ", "weights", " ",
     "from", " ", "a", " ", "uniform", " ", "distirbution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"output", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "success", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"success", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"weights", "=", 
              RowBox[{"RandomReal", "[", 
               RowBox[{
                RowBox[{"UniformDistribution", "[", "]"}], ",", "Np"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Sloc", "=", 
              RowBox[{"RandomChoice", "[", 
               RowBox[{
                RowBox[{"weights", "->", 
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "Np", ",", "1"}], "]"}]}], ",", "NS"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Iloc", "=", 
              RowBox[{"RandomChoice", "[", 
               RowBox[{
                RowBox[{"weights", "->", 
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", "Np", ",", "1"}], "]"}]}], ",", "NI"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Intersection", "[", 
                  RowBox[{"Sloc", ",", "Iloc"}], "]"}], "]"}], ">", "0"}], ",", 
               RowBox[{"success", "++"}]}], "]"}]}], ",", 
            RowBox[{"{", "reps", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NS", "/", "Np"}], ",", 
            RowBox[{"N", "[", 
             RowBox[{"success", "/", "reps"}], "]"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"NS", ",", "1", ",", "Np"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"plot3", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"plot2", ",", "\n", "\t", 
      RowBox[{"plotrnun", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", "output", "}"}], ",", 
         RowBox[{"Frame", "->", 
          RowBox[{"{", 
           RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}],
          ",", "\n", "\t", 
         RowBox[{"PlotStyle", "->", 
          RowBox[{"RGBColor", "[", "\"\<#93e1d8\>\"", "]"}]}], ",", "\n", 
         "\t", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<S/N\>\"", ",", "\"\<Prob. of co-location\>\""}], 
           "}"}]}], ",", "\n", "\t", 
         RowBox[{"PlotLegends", "->", 
          RowBox[{
          "{", "\"\<uniform random \!\(\*TemplateBox[<|\"boxes\" -> FormBox[
SubscriptBox[
StyleBox[\"w\", \"TI\"], 
StyleBox[\"i\", \"TI\"]], TraditionalForm], \"errors\" -> {}, \"input\" -> \
\"w_{i}\", \"state\" -> \"Boxes\"|>,\"TeXAssistantTemplate\"]\)\>\"", 
           "}"}]}]}], "]"}]}]}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{
  3.964261565615584*^9},ExpressionUUID->"936ed49c-c3c4-40b3-90fe-\
c492f724b116"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 866},
WindowMargins->{{12, Automatic}, {Automatic, 24}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b53831ee-f3d4-4ea8-9562-4928de432484"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 176, 3, 96, "Title",ExpressionUUID->"9b064bd4-2d6b-4429-bb90-3ff55700105a"],
Cell[755, 27, 506, 9, 77, "Text",ExpressionUUID->"e7e2ddb2-7e92-4cf1-90cb-9715657c9334"],
Cell[CellGroupData[{
Cell[1286, 40, 165, 3, 66, "Section",ExpressionUUID->"e1119d78-dffc-47d5-ac4a-fd539da22a1f"],
Cell[1454, 45, 438, 9, 77, "Text",ExpressionUUID->"3f17c6ac-d29a-4c26-9b5a-2b0f9c332007"],
Cell[CellGroupData[{
Cell[1917, 58, 5773, 138, 583, "Code",ExpressionUUID->"1e77069e-428f-4574-9e5c-27eda31ab296"],
Cell[7693, 198, 17557, 367, 255, "Output",ExpressionUUID->"b2de842c-21f3-4d15-90ef-540c9f86c911"]
}, Open  ]],
Cell[25265, 568, 2137, 58, 227, "Code",ExpressionUUID->"e5bd0fe4-d1ce-4311-abe9-44b2975fade9"],
Cell[27405, 628, 3389, 83, 321, "Code",ExpressionUUID->"936ed49c-c3c4-40b3-90fe-c492f724b116"]
}, Open  ]]
}, Open  ]]
}
]
*)

