(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     35048,        970]
NotebookOptionsPosition[     33906,        941]
NotebookOutlinePosition[     34298,        957]
CellTagsIndexPosition[     34255,        954]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Transmission as a process of co-location on a weighted landscape\
\>", "Title",
 CellChangeTimes->{{3.962190085292677*^9, 3.96219008821032*^9}, {
  3.96219540883263*^9, 
  3.962195411808811*^9}},ExpressionUUID->"b538b393-b660-4958-9bf0-\
8a29604ee37f"],

Cell["\<\
This notebook shows how co-location on a weighted landscape can be understood \
as a function of individuals behavioural choices to select a given landscape\
\>", "Text",
 CellChangeTimes->{{3.9621901097899847`*^9, 3.962190150590192*^9}, {
  3.96219089277697*^9, 3.962190897753039*^9}, {3.962190928888867*^9, 
  3.962190942581951*^9}, {3.962195414195766*^9, 
  3.962195442977254*^9}},ExpressionUUID->"071d693b-02eb-4144-af51-\
79ee8493aa38"],

Cell[CellGroupData[{

Cell["Set up ", "Section",
 CellChangeTimes->{{3.962190948038754*^9, 3.962190949920525*^9}, {
  3.962190984037097*^9, 
  3.962190992876903*^9}},ExpressionUUID->"e78c1de1-8c99-4ef2-ba7b-\
dccf218c0e9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"First", ",", " ", 
    RowBox[{
    "some", " ", "directory", " ", "stuff", " ", "for", " ", "outputting", " ",
      "plot"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
    "baseDir", "=", "\"\</Users/colebrookson/github/theRmal-landscape/\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"figsDir", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"baseDir", ",", "\"\<figs\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"relativePath", "[", "parts__", "]"}], ":=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"baseDir", ",", "parts"}], "}"}], "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.9621909960640182`*^9, 3.96219101171208*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"bdbf9023-b829-4363-b6e6-27baee5bc5c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Landscape weights", "Section",
 CellChangeTimes->{{3.962193704538856*^9, 3.962193714024947*^9}, {
  3.962195482954383*^9, 
  3.9621954983931427`*^9}},ExpressionUUID->"ba4353db-02da-4d8f-8ae4-\
ad0e751fe1f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"00", "  ", "helpers"}], 
   "                                                             ", "*)"}], 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "normalizeWeights", ",", " ", "binFreq", ",", " ", "boolFreq", ",", " ", 
     "sampleIndices"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"normalizeWeights", "[", "v_", "]"}], " ", ":=", " ", 
    RowBox[{"v", "/", 
     RowBox[{"Total", "[", "v", "]"}]}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"return", " ", "frequency", " ", "of", " ", "condition", " ", 
     RowBox[{"(", 
      RowBox[{"boolean", " ", "vector"}], ")"}], " ", "over", " ", "reps"}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"boolFreq", "[", "mat_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"Total", "[", 
       RowBox[{"mat", ",", " ", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "/", 
     RowBox[{"Length", "[", "mat", "]"}]}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "random", " ", "sample", " ", "of", " ", "indices", " ", "for", " ", 
     "plotting", " ", "to", " ", "keep", " ", "things", " ", "light"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"sampleIndices", "[", 
     RowBox[{"n_", ",", " ", "max_"}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", " ", "<=", " ", "max"}], ",", " ", 
      RowBox[{"Range", "[", "n", "]"}], ",", " ", 
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", " ", "max"}], "]"}]}], "]"}]}],
    "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"01", "  ", "weight", " ", "generators"}], 
    "                                                    ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{"ClearAll", "[", "makeWeights", "]"}], "\n", 
   RowBox[{
    RowBox[{"makeWeights", "[", 
     RowBox[{"dist_", ",", " ", "n_", ",", " ", 
      RowBox[{"distParams_", ":", " ", 
       RowBox[{"<|", "|>"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "raw", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"Switch", "[", 
        RowBox[{
        "dist", ",", "\n", "    ", "\"\<uniform\>\"", ",", "\n", "      ", 
         RowBox[{"raw", " ", "=", " ", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", "n"}], "]"}]}], ",",
          "\n", "    ", "\"\<normal\>\"", ",", "\n", "      ", 
         RowBox[{"raw", " ", "=", " ", 
          RowBox[{"RandomVariate", "[", "\n", "        ", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", "\n", "          ", 
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{
               "distParams", ",", " ", "\"\<mu\>\"", ",", " ", "0.5"}], "]"}],
               ",", " ", 
              RowBox[{"Lookup", "[", 
               RowBox[{
               "distParams", ",", " ", "\"\<sd\>\"", ",", " ", "0.2"}], 
               "]"}]}], "\n", "        ", "]"}], ",", "\n", "        ", "n"}],
            "\n", "      ", "]"}]}], ",", "\n", "    ", "\"\<lognormal\>\"", ",",
          "\n", "      ", 
         RowBox[{"raw", " ", "=", " ", 
          RowBox[{"RandomVariate", "[", "\n", "        ", 
           RowBox[{
            RowBox[{"LogNormalDistribution", "[", "\n", "          ", 
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{"distParams", ",", " ", "\"\<mu\>\"", ",", " ", 
                RowBox[{"-", "1.0"}]}], "]"}], ",", " ", 
              RowBox[{"Lookup", "[", 
               RowBox[{
               "distParams", ",", " ", "\"\<sd\>\"", ",", " ", "0.5"}], 
               "]"}]}], "\n", "        ", "]"}], ",", "\n", "        ", "n"}],
            "\n", "      ", "]"}]}], ",", "\n", "    ", "\"\<exponential\>\"",
          ",", "\n", "      ", 
         RowBox[{"raw", " ", "=", " ", 
          RowBox[{"RandomVariate", "[", "\n", "        ", 
           RowBox[{
            RowBox[{"ExponentialDistribution", "[", 
             RowBox[{"Lookup", "[", 
              RowBox[{
              "distParams", ",", " ", "\"\<rate\>\"", ",", " ", "1.0"}], 
              "]"}], "]"}], ",", " ", "n"}], "\n", "      ", "]"}]}], ",", 
         "\n", "    ", "_", ",", " ", "\n", "      ", 
         RowBox[{"raw", " ", "=", " ", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", "n"}], "]"}]}]}], 
        "\n", "  ", "]"}], ";", "\n", "  ", 
       RowBox[{"raw", " ", "=", " ", 
        RowBox[{"Clip", "[", 
         RowBox[{"raw", ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "Infinity"}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"ensure", " ", "nonnegative"}], " ", "*)"}], "\n", "  ", 
       RowBox[{"normalizeWeights", "[", "raw", "]"}]}]}], "\n", "]"}]}], "\n",
    "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"02", "  ", "analytic", " ", "probability", " ", "functions"}], 
    "                                      ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{"ClearAll", "[", "analyticProbs", "]"}], "\n", 
   RowBox[{
    RowBox[{"analyticProbs", "[", 
     RowBox[{"w_", ",", " ", "s_", ",", " ", "i_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ps", ",", " ", "pi", ",", " ", "pco", ",", " ", "pco1"}], 
       "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"ps", "   ", "=", " ", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", " ", "-", " ", "w"}], ")"}], "^", "s"}]}]}], ";", 
       "\n", "  ", 
       RowBox[{"pi", "   ", "=", " ", 
        RowBox[{"1", " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", " ", "-", " ", "w"}], ")"}], "^", "i"}]}]}], ";", 
       "\n", "  ", 
       RowBox[{"pco", "  ", "=", " ", 
        RowBox[{"ps", "*", "pi"}]}], ";", "\n", "  ", 
       RowBox[{"pco1", " ", "=", " ", 
        RowBox[{"ps", "*", "w"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"special", " ", "case", " ", "i"}], " ", "==", " ", "1"}], 
        " ", "*)"}], "\n", "  ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<pS\>\"", " ", "->", " ", "ps"}], ",", " ", 
         RowBox[{"\"\<pI\>\"", " ", "->", " ", "pi"}], ",", " ", 
         RowBox[{"\"\<pCo\>\"", " ", "->", " ", "pco"}], ",", " ", 
         RowBox[{"\"\<pCoIeq1\>\"", " ", "->", " ", "pco1"}]}], "|>"}]}]}], 
     "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"03", "  ", "single", " ", "replicate", " ", "simulation"}], 
    "                                          ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{"ClearAll", "[", "oneRep", "]"}], "\n", 
   RowBox[{
    RowBox[{"oneRep", "[", 
     RowBox[{"w_", ",", " ", "s_", ",", " ", "i_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "[", "w", "]"}]}], ",", " ", "susIdx", ",", " ", 
        "infIdx", ",", " ", "hasS", ",", " ", "hasI"}], "}"}], ",", "\n", 
      "  ", 
      RowBox[{
       RowBox[{"susIdx", " ", "=", " ", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{"w", " ", "->", " ", 
           RowBox[{"Range", "[", "n", "]"}]}], ",", " ", "s"}], "]"}]}], ";", 
       "\n", "  ", 
       RowBox[{"infIdx", " ", "=", " ", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{
          RowBox[{"w", " ", "->", " ", 
           RowBox[{"Range", "[", "n", "]"}]}], ",", " ", "i"}], "]"}]}], ";", 
       "\n", "  ", 
       RowBox[{"hasS", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"False", ",", " ", "n"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"hasI", " ", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"False", ",", " ", "n"}], "]"}]}], ";", "\n", "  ", 
       RowBox[{
        RowBox[{"hasS", "[", 
         RowBox[{"[", "susIdx", "]"}], "]"}], " ", "=", " ", "True"}], ";", 
       "\n", "  ", 
       RowBox[{
        RowBox[{"hasI", "[", 
         RowBox[{"[", "infIdx", "]"}], "]"}], " ", "=", " ", "True"}], ";", 
       "\n", "  ", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<hasS\>\"", " ", "->", " ", "hasS"}], ",", " ", 
         RowBox[{"\"\<hasI\>\"", " ", "->", " ", "hasI"}], ",", " ", 
         RowBox[{"\"\<co\>\"", " ", "->", " ", 
          RowBox[{"(", 
           RowBox[{"hasS", " ", "&&", " ", "hasI"}], ")"}]}]}], "|>"}]}]}], 
     "\n", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.962195501282391*^9, 3.962195502357568*^9}, {
  3.962195542382707*^9, 
  3.962195571089538*^9}},ExpressionUUID->"82777e24-8ab0-46ce-8687-\
2ca7e077cb91"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulations", "Section",
 CellChangeTimes->{{3.962195583627139*^9, 
  3.962195587398624*^9}},ExpressionUUID->"5f1255eb-c4f3-4d9a-b998-\
9d9a9ed91cca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"04", "  ", "run", " ", "many", " ", "simulations"}], 
   "                                                 ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{
   RowBox[{"ClearAll", "[", "runSims", "]"}], "\n", 
   RowBox[{
    RowBox[{"runSims", "[", 
     RowBox[{"w_", ",", " ", "s_", ",", " ", "i_", ",", " ", "reps_"}], "]"}],
     " ", ":=", " ", 
    RowBox[{"Module", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "results", ",", " ", "hasSMat", ",", " ", "hasIMat", ",", " ", 
        "coMat"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"results", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"oneRep", "[", 
           RowBox[{"w", ",", " ", "s", ",", " ", "i"}], "]"}], ",", " ", 
          RowBox[{"{", "reps", "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"hasSMat", " ", "=", " ", 
        RowBox[{"results", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "\"\<hasS\>\""}], "]"}], "]"}]}], ";", 
       "\n", "  ", 
       RowBox[{"hasIMat", " ", "=", " ", 
        RowBox[{"results", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "\"\<hasI\>\""}], "]"}], "]"}]}], ";", 
       "\n", "  ", 
       RowBox[{"coMat", "   ", "=", " ", 
        RowBox[{"results", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", " ", "\"\<co\>\""}], "]"}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"<|", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<pShat\>\"", " ", "->", " ", 
          RowBox[{"boolFreq", "[", "hasSMat", "]"}]}], ",", "\n", "    ", 
         RowBox[{"\"\<pIhat\>\"", " ", "->", " ", 
          RowBox[{"boolFreq", "[", "hasIMat", "]"}]}], ",", "\n", "    ", 
         RowBox[{"\"\<pCohat\>\"", " ", "->", " ", 
          RowBox[{"boolFreq", "[", "coMat", "]"}]}]}], "\n", "  ", "|>"}]}]}],
      "\n", "]"}]}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"05", "  ", "comparison"}], " ", "+", " ", "plotting"}], 
    "                                                ", "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], "\n", "\n", 
   RowBox[{"ClearAll", "[", "compareAndPlot", "]"}], "\n", 
   RowBox[{
    RowBox[{"compareAndPlot", "[", 
     RowBox[{
     "w_", ",", " ", "s_", ",", " ", "i_", ",", " ", "reps_", ",", " ", 
      RowBox[{"plotSample_", ":", " ", "5000"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "an", ",", " ", "sim", ",", " ", "idx", ",", " ", "dataPS", ",", " ", 
        "dataPCo", ",", " ", "plot1", ",", " ", "plot2", ",", " ", "absErrS", 
        ",", " ", "absErrCo"}], "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"an", "  ", "=", " ", 
        RowBox[{"analyticProbs", "[", 
         RowBox[{"w", ",", " ", "s", ",", " ", "i"}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"sim", " ", "=", " ", 
        RowBox[{"runSims", "[", 
         RowBox[{"w", ",", " ", "s", ",", " ", "i", ",", " ", "reps"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"idx", " ", "=", " ", 
        RowBox[{"sampleIndices", "[", 
         RowBox[{
          RowBox[{"Length", "[", "w", "]"}], ",", " ", "plotSample"}], 
         "]"}]}], ";", "\n", "\n", "  ", 
       RowBox[{"dataPS", "  ", "=", " ", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"an", "[", "\"\<pS\>\"", "]"}], "[", 
            RowBox[{"[", "idx", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"sim", "[", "\"\<pShat\>\"", "]"}], "[", 
            RowBox[{"[", "idx", "]"}], "]"}]}], "}"}], "]"}]}], ";", "\n", 
       "  ", 
       RowBox[{"dataPCo", " ", "=", " ", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"an", "[", "\"\<pCo\>\"", "]"}], "[", 
            RowBox[{"[", "idx", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"sim", "[", "\"\<pCohat\>\"", "]"}], "[", 
            RowBox[{"[", "idx", "]"}], "]"}]}], "}"}], "]"}]}], ";", "\n", 
       "\n", "  ", 
       RowBox[{"absErrS", "  ", "=", " ", 
        RowBox[{"Mean", "@", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"dataPS", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], " ", "-", " ", 
           RowBox[{"dataPS", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}]}], ";", 
       "\n", "  ", 
       RowBox[{"absErrCo", " ", "=", " ", 
        RowBox[{"Mean", "@", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"dataPCo", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], " ", "-", " ", 
           RowBox[{"dataPCo", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", "1"}], "]"}], "]"}]}], "]"}]}]}], ";", 
       "\n", "\n", "  ", 
       RowBox[{"plot1", " ", "=", " ", 
        RowBox[{"ListPlot", "[", "\n", "    ", 
         RowBox[{"dataPS", ",", "\n", "    ", 
          RowBox[{"AxesLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<analytic pS\>\"", ",", " ", "\"\<empirical pS\>\""}],
             "}"}]}], ",", "\n", "    ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], ",", "\n", 
          "    ", 
          RowBox[{"AspectRatio", " ", "->", " ", "1"}], ",", "\n", "    ", 
          RowBox[{"PlotTheme", " ", "->", " ", "\"\<Scientific\>\""}]}], "\n",
          "  ", "]"}]}], ";", "\n", "\n", "  ", 
       RowBox[{"plot2", " ", "=", " ", 
        RowBox[{"ListPlot", "[", "\n", "    ", 
         RowBox[{"dataPCo", ",", "\n", "    ", 
          RowBox[{"AxesLabel", " ", "->", " ", 
           RowBox[{"{", 
            
            RowBox[{"\"\<analytic pCo\>\"", ",", 
             " ", "\"\<empirical pCo\>\""}], "}"}]}], ",", "\n", "    ", 
          RowBox[{"PlotRange", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], ",", "\n", 
          "    ", 
          RowBox[{"AspectRatio", " ", "->", " ", "1"}], ",", "\n", "    ", 
          RowBox[{"PlotTheme", " ", "->", " ", "\"\<Scientific\>\""}]}], "\n",
          "  ", "]"}]}], ";", "\n", "\n", "  ", 
       RowBox[{"<|", "\n", "    ", 
        RowBox[{
         RowBox[{"\"\<analytic\>\"", " ", "->", " ", "an"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<empirical\>\"", " ", "->", " ", "sim"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<absErrS\>\"", " ", "->", " ", "absErrS"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<absErrCo\>\"", " ", "->", " ", "absErrCo"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<plotPS\>\"", " ", "->", " ", "plot1"}], ",", "\n", 
         "    ", 
         RowBox[{"\"\<plotPCo\>\"", " ", "->", " ", "plot2"}]}], "\n", "  ", 
        "|>"}]}]}], "\n", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.962195589827044*^9, 3.962195591650794*^9}, {
  3.962195636222321*^9, 
  3.962195637217835*^9}},ExpressionUUID->"4dc06965-f9c4-41e6-8a45-\
6c0051dfdb6e"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{870, 866},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"14.2 for Mac OS X ARM (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6387259a-7e59-4606-a29c-a8f162d71d51"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 262, 6, 157, "Title",ExpressionUUID->"b538b393-b660-4958-9bf0-8a29604ee37f"],
Cell[841, 30, 451, 8, 55, "Text",ExpressionUUID->"071d693b-02eb-4144-af51-79ee8493aa38"],
Cell[CellGroupData[{
Cell[1317, 42, 201, 4, 66, "Section",ExpressionUUID->"e78c1de1-8c99-4ef2-ba7b-dccf218c0e9b"],
Cell[1521, 48, 878, 23, 107, "Code",ExpressionUUID->"bdbf9023-b829-4363-b6e6-27baee5bc5c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2436, 76, 213, 4, 66, "Section",ExpressionUUID->"ba4353db-02da-4d8f-8ae4-ad0e751fe1f3"],
Cell[2652, 82, 18682, 516, 1446, "Code",ExpressionUUID->"82777e24-8ab0-46ce-8687-2ca7e077cb91"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21371, 603, 156, 3, 66, "Section",ExpressionUUID->"5f1255eb-c4f3-4d9a-b998-9d9a9ed91cca"],
Cell[21530, 608, 12348, 329, 1163, "Code",ExpressionUUID->"4dc06965-f9c4-41e6-8a45-6c0051dfdb6e"]
}, Open  ]]
}, Open  ]]
}
]
*)

